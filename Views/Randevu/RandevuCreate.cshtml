@model SalonYonetimUygulamasi.Models.Randevu



<form asp-action="RandevuCreate" method="post">


    <div class="form-group">
        <label for="TarihDate">Tarih</label>
        <select asp-for="TarihDate" class="form-control" required>
            @foreach (var date in ViewBag.Dates)
            {
                <option value="@date">@date</option>
            }
        </select>
    </div>

    <!-- Saat Seçimi -->
    <div class="form-group">
        <label for="TarihTime">Saat</label>
        <select asp-for="TarihTime" class="form-control" required>
            @if (ViewBag.Hours != null)
            {
                foreach (var hour in ViewBag.Hours)
                {
                    <option value="@hour">@hour</option>
                }
            }
            else
            {
                <option value="">Saatler yükleniyor...</option>
            }
        </select>
    </div>
    
    <!-- İşlem Seçimi -->
    <div class="form-group">
        <label for="IslemID">İşlem Seçin</label>
        <select asp-for="IslemID" class="form-control" asp-items="@(new SelectList(ViewBag.Islemler, "IslemID", "IslemAdi"))" required onchange="setPrice()">
            <option value="">-- İşlem Seçin --</option>
        </select>
    </div>

    <!-- İşlem Ücreti -->
    <div class="form-group">
        <label for="IslemUcreti">Ücret</label>
        <input type="text" class="form-control" id="IslemUcreti" name="IslemUcreti" value="@Model.IslemUcreti" readonly />
    </div>

    <!-- Çalışan Seçimi -->
    <div class="form-group">
        <label for="CalisanID">Çalışan Seçin</label>
        <select asp-for="CalisanID" class="form-control" asp-items="@(new SelectList(ViewBag.Calisanlar, "CalisanID", "CalisanAd"))" required>
            <option value="">-- Çalışan Seçin --</option>
        </select>
    </div>

    <button type="submit" class="btn btn-primary">Randevu Al</button>
</form>

<script>
    function setPrice() {
        const islemSelect = document.getElementById("IslemID");
        const ucretField = document.getElementById("IslemUcreti");
        const islemID = islemSelect.value;

        if (islemID) {
            // Dinamik olarak işlem ücretini belirle
            const selectedIslem = @Html.Raw(Json.Serialize(ViewBag.Islemler));
            const islem = selectedIslem.find(i => i.IslemID == islemID);
            if (islem) {
                ucretField.value = islem.IslemUcreti;
            }
        } else {
            ucretField.value = '';
        }
    }
</script>

